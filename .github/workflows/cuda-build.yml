name: CUDA Build

on:
  push:
    branches:
      - V2.0  # Change to your default branch name
  pull_request:
    branches:
      - V2.0  # Change to your default branch name
  release:
    types: [created]  # Trigger on release creation

jobs:
  build-windows:
    runs-on: windows-latest

    steps:
    - name: Check out code
      uses: actions/checkout@v2

    - name: Set up CUDA
      uses: actions/setup-cuda@v1
      with:
        cuda-version: 12.6.1  # Specify your CUDA version

    - name: Build with MSBuild
      run: |
        # Restore NuGet packages if needed (uncomment if you use NuGet)
        # nuget restore BruteForceMnemonicCUDA.sln
        
        # Build the solution
        msbuild BruteForceMnemonicCUDA.sln /p:Configuration=Release

    - name: Create Release
      id: create_release
      uses: softprops/action-gh-release@v1
      with:
        tag: ${{ github.ref }}
        files: x64/Release/BruteForceMnemonicBitcoinV200.exe  # Specify the correct path to your executable
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
